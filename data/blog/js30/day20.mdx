---
title: 'Day20: Speech Detection'
date: 2021-07-13
tags: ['JavaScript30', 'tech']
draft: false
summary: 'å¦‚ä½•ä½¿ç”¨ JavaScript å’Œ Web Speech API ä¾†å¯¦ç¾èªéŸ³è­˜åˆ¥åŠŸèƒ½ã€‚'
images:
authors: ['chick_playground']
---

ç°¡ä»‹ï¼š å¦‚ä½•ä½¿ç”¨ JavaScript å’Œ Web Speech API ä¾†å¯¦ç¾èªéŸ³è­˜åˆ¥åŠŸèƒ½ã€‚

ä½œå“é é¢ï¼šhttps://iris1114.github.io/javascript30/20_Speech-Detection/

### HTML

- åŒ…å«ä¸€å€‹ `div` å®¹å™¨ï¼Œå…§éƒ¨è¨­ç½®ç‚ºå¯ç·¨è¼¯ï¼Œç”¨æ–¼é¡¯ç¤ºèªéŸ³è­˜åˆ¥çµæœã€‚

```html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Speech Detection</title>
  </head>
  <body>
    <div class="words" contenteditable></div>

    <script src="scripts.js"></script>
  </body>
</html>
```

### JavaScript

- ä½¿ç”¨ JavaScript å’Œ Web Speech API ä¾†å¯¦ç¾èªéŸ³è­˜åˆ¥åŠŸèƒ½ï¼Œä¸¦å°‡è­˜åˆ¥çµæœé¡¯ç¤ºåœ¨é é¢ä¸Šã€‚

```javascript
// ç²å– SpeechRecognition ç‰©ä»¶
window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition

const recognition = new SpeechRecognition()
recognition.interimResults = true
recognition.lang = 'en-US'

let p = document.createElement('p')
const words = document.querySelector('.words')
words.appendChild(p)

// ç•¶æœ‰èªéŸ³è­˜åˆ¥çµæœæ™‚è§¸ç™¼
recognition.addEventListener('result', (e) => {
  const transcript = Array.from(e.results)
    .map((result) => result[0])
    .map((result) => result.transcript)
    .join('')

  // å°‡ä¸é›…è©å½™æ›¿æ›ç‚ºè¡¨æƒ…ç¬¦è™Ÿ
  const poopScript = transcript.replace(/poop|poo|shit|dump/gi, 'ğŸ’©')
  p.textContent = poopScript

  // å¦‚æœçµæœæ˜¯æœ€çµ‚çµæœï¼Œå‰‡å‰µå»ºæ–°çš„æ®µè½
  if (e.results[0].isFinal) {
    p = document.createElement('p')
    words.appendChild(p)
  }
})

// ç•¶èªéŸ³è­˜åˆ¥çµæŸæ™‚é‡æ–°å•Ÿå‹•
recognition.addEventListener('end', recognition.start)

// é–‹å§‹èªéŸ³è­˜åˆ¥
recognition.start()
```

### Note

- ä½¿ç”¨ `window.SpeechRecognition` æˆ– `window.webkitSpeechRecognition` ä¾†ç²å– SpeechRecognition ç‰©ä»¶ã€‚
- è¨­ç½® `interimResults` ç‚º `true` ä»¥ç²å–å³æ™‚çµæœã€‚
- ä½¿ç”¨ `addEventListener` ä¾†ç›£è½èªéŸ³è­˜åˆ¥çµæœå’ŒçµæŸäº‹ä»¶ã€‚
- ä½¿ç”¨æ­£å‰‡è¡¨é”å¼ä¾†æ›¿æ›ä¸é›…è©å½™ã€‚
